from pwn import *
R = remote('challenges.traboda.com', 30840)

#level-1
R.recv()
R.sendline(b'madrid')

#level-2
R.recv()
R.sendline(b'vincent van gogh')

#level-3
R.recv()
R.sendline(b'alan turing')

#level-4
R.recvuntil("a) Find their mean!\n\n")
info = R.recv()
info1 = info.decode('utf-8')
marks = info1.split()

summ = 0
marks = [i for i in marks if i.isdigit()]

for mark in marks:
	mark = int(mark)
	summ += mark
	
mean = summ/len(marks)
R.sendline(str(int(mean)))


#level-5
data = R.recv()

number = []
for word in data.split():
   word = word.decode('utf-8')
   if word.isdigit():
      number.append(int(word))

new_studmark = ((mean*(len(marks)+int(number[0])))-summ)
R.sendline(str(int(new_studmark)))


#level-6
R.recvuntil("Here are five numbers. You need to input the numbers in an increasing order!\n")
num_data = R.recv()
num_data1 = num_data.decode("utf-8")
asc_data = num_data1.split()

asc_lst = []
for n in asc_data:
    if(n.isdigit()):
        asc_lst.append(int(n))
asc_lst.sort()
R.sendline(str(asc_lst))

#sublevel-1
R.recv()
R.sendline(b'crypto{ASCII_pr1nt4bl3}')



#sublevel-2
R.recv()
R.sendline(b'EMYPU DDVAQ')


#sublevel-3
R.recv()
R.sendline(b'13371337')


#sublevel-4
R.recv()
R.sendline(b'YELLOW SUBMARINE!!')


#sublevel-5
R.recvuntil('''Wow that was soo amazing! You have cracked all the levels! You really are a genius!


The flag is scrambled. Unscramble it to get the real flag! :)

Your flag is: fa{_mS07_0_47b4_3!}!m73_ncuY!rm_aIgl''')



R.sendline('flag{I_am_Sm0r7!_Y0u_c4n7_b347_m3!!}')

R.interactive()

